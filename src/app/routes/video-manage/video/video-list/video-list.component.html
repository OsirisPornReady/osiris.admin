<page-header [home]="''" [title]="''"></page-header>
<nz-card>
  <sf mode="search" [schema]="searchSchema" [ui]="ui" [formData]="searchParam" (formSubmit)="st.reset($event)" (formReset)="st.reset($event)"></sf>
  <div nz-row class="my-md">
    <div nz-col [nzXs]="24" [nzLg]="24">
      <div class="mb-md">
        <nz-switch [(ngModel)]="isAutoCreate"
                   [nzCheckedChildren]="'自动'"
                   [nzUnCheckedChildren]="'手动'"
                   class="mr-md"></nz-switch>
        <nz-switch [(ngModel)]="isOpenMultiSelect"
                   [nzCheckedChildren]="'批量'"
                   [nzUnCheckedChildren]="'单条'"
                   [nzDisabled]="isAutoCreate"
                   (ngModelChange)="switchMultiSelect()"
                   class="mr-md"></nz-switch>
      </div>
      <div>
        <div *ngIf="!isAutoCreate">
          <button nz-button nzType="dashed" (click)="addEdit()">添加</button>
          <button nz-button nzType="default" nzDanger (click)="bulkDelete(st._data)" *ngIf="isOpenMultiSelect">批量删除</button>
        </div>
        <div *ngIf="isAutoCreate">
          <input nz-input placeholder="serial number" [(ngModel)]="autoCreateSerialNumber" class="width-md mr-md" (keydown.enter)="autoCreate()"/>
          <button nz-button nzType="dashed" nzShape="round" type="button" (click)="autoCreate()">
            <span nz-icon nzType="api" nzTheme="outline"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
  <st #st [data]="url" [columns]="columns" [page]="page" [widthMode]="{ type: 'strict' }">
    <ng-template st-row="customVideoStatus" let-item>
      <nz-badge [nzStatus]="statusBADGE[getVideoStatus(item)].color" [nzText]="statusBADGE[getVideoStatus(item)].text"></nz-badge>
    </ng-template>

    <ng-template st-row="customVideoQuality" let-item>
      <nz-tag *ngIf="getVideoQuality(item)" [nzColor]="qualityTAG[getVideoQuality(item)].color" class="st-single-nz-tag">{{ qualityTAG[getVideoQuality(item)].text }}</nz-tag>
      <span *ngIf="!getVideoQuality(item)" nz-typography nzDisabled>未知</span>
    </ng-template>

    <ng-template st-row="customVideoInfoCrawlButton" let-item>
      <button nz-button type="button" nzType="default" nzShape="round" (click)="crawlInfo(item)" *ngIf="item.existSerialNumber">
        <span nz-icon nzType="api" nzTheme="outline"></span>
      </button>
    </ng-template>

    <ng-template st-row="customVideoOnSubscription" let-item>
      <span nz-icon
            nzType="check-circle"
            nzTheme="twotone"
            nzTwotoneColor="#52c41a"
            [ngClass]="['custom-twotone-checked-icon']"
            [ngStyle]="{
              'opacity': (item.onSubscription ? '1' : '0')
            }"></span>
    </ng-template>

    <ng-template st-row="customSwitchVideoSubscription" let-item>
      <button nz-button type="button" nzType="default" nzShape="circle" (click)="switchVideoSubscription(item)">
        <span  nz-icon nzType="bell" nzTheme="outline"></span>
      </button>
    </ng-template>
  </st>
</nz-card>
